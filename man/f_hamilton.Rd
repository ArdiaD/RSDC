% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/model_fit.R
\name{f_hamilton}
\alias{f_hamilton}
\title{Hamilton Filter with Time-Varying or Fixed Transition Probabilities}
\usage{
f_hamilton(y, X = NULL, beta = NULL, rho_matrix, K, N, P = NULL)
}
\arguments{
\item{y}{A numeric matrix of dimension T × K containing the observed time series (e.g., standardized residuals).}

\item{X}{An optional numeric matrix of dimension T × p of exogenous covariates used for TVTP.
Required if \code{beta} is provided.}

\item{beta}{An optional numeric matrix of dimension N × p. Logistic regression coefficients governing
the regime-specific persistence probabilities in the TVTP specification.}

\item{rho_matrix}{A numeric matrix of dimension N × C, where C = K(K−1)/2.
Each row contains the lower-triangular correlation parameters for one regime.}

\item{K}{Integer. Number of observed variables.}

\item{N}{Integer. Number of regimes.}

\item{P}{An optional N × N fixed transition matrix (used when \code{X} and \code{beta} are \code{NULL}).}
}
\value{
A list with components:
\describe{
\item{filtered_probs}{A numeric matrix of dimension N × T.
Contains the filtered regime probabilities \eqn{\Pr(S_t = j \mid \Omega_t)}.}
\item{smoothed_probs}{A numeric matrix of dimension N × T.
Contains the smoothed regime probabilities \eqn{\Pr(S_t = j \mid \Omega_T)}.}
\item{log_likelihood}{The scalar log-likelihood value of the model given the data.}
}
}
\description{
Implements the Hamilton filter for a multivariate time series under a regime-switching correlation model.
Supports both fixed transition probabilities and time-varying transition probabilities (TVTP)
modeled via logistic functions of exogenous covariates.
}
\details{
The function computes the filtered and smoothed probabilities of the latent regime sequence, and
evaluates the log-likelihood under the specified model.

When \code{X} and \code{beta} are both provided, the function builds a time-varying transition
matrix \eqn{\Pi_t} using a logistic specification for the diagonal elements, and equal off-diagonal
probabilities. When omitted, the transition matrix is either fixed (if \code{P} is supplied)
or assumed uniform (if \code{P} is \code{NULL}).

The correlation matrices are reconstructed from the lower-triangular parameters in \code{rho_matrix}.
The likelihood is computed using multivariate normal densities with mean zero and unit variance.
}
